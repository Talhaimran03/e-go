<!DOCTYPE html>
<html>
<head>
    <title>Mappa con percorso e fermate del bus</title>
    <!-- Aggiungi il CSS di Leaflet -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
</head>
<body>
    <h1>Percorso con fermate del bus</h1>
    <div id="map" style="width: 600px; height: 450px;"></div>

    <!-- Aggiungi il JavaScript di Leaflet -->
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script>
        // Crea una mappa utilizzando Leaflet
        const map = L.map('map').setView([45.45742120, 10.94631000], 16);
        
        // Imposta il massimo livello di zoom
        map.setMaxZoom(18);

        // Aggiungi uno strato di mappa di OpenStreetMap
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; OpenStreetMap contributors'
        }).addTo(map);

        // Aggiungi il percorso alla mappa
        function addRouteToMap(route) {
            const routeCoordinates = route.routes[0].geometry.coordinates;
            const latLngs = routeCoordinates.map(coord => [coord[1], coord[0]]);
            L.polyline(latLngs, { color: 'blue' }).addTo(map);
        }

        // Aggiungi i segnaposto delle fermate del bus
        function addBusStopsToMap() {
            // Coordinate delle fermate del bus
            const busStops = [
                { lat: 45.45742120, lng: 10.94631000, name: 'Fermata inizio bus' },
                { lat: 45.46287260, lng: 10.93376780, name: 'Fermata fine bus' }
            ];

            // Aggiungi i segnaposto delle fermate del bus alla mappa
            busStops.forEach(stop => {
                L.marker([stop.lat, stop.lng]).addTo(map).bindPopup(stop.name);
            });
        }

        // Effettua la richiesta HTTP GET per ottenere il percorso
        const baseUrl = 'https://router.project-osrm.org/route/v1/driving/';
        const coordinates = '10.94631000,45.45742120;10.93376780,45.46287260';
        const options = '?steps=true&geometries=geojson';
        const requestUrl = baseUrl + coordinates + options;

        fetch(requestUrl)
            .then(response => response.json())
            .then(data => {
                // Aggiungi il percorso alla mappa
                addRouteToMap(data);
                
                // Aggiungi i segnaposto delle fermate del bus alla mappa
                addBusStopsToMap();
            })
            .catch(error => {
                console.error('Si Ã¨ verificato un errore durante la richiesta di routing:', error);
            });
    </script>
</body>
</html>


